<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>管理者テンプレ編集（Gist）</title>
  <style>
    body { font-family: sans-serif; padding: 2em; max-width: 800px; margin: auto; }
    input, button, textarea { font-size: 1em; margin-top: 0.5em; width: 100%; }
    textarea { height: 200px; }
  </style>
</head>
<body>
  <h1>🔐 管理者テンプレート編集（GitHub Gist）</h1>

  <label for="token">GitHubトークン：</label>
  <input type="password" id="token" placeholder="ghp_..." />

  <label for="gistId">Gist ID：</label>
  <input id="gistId" value="YOUR_GIST_ID_HERE" />

  <label for="content">テンプレート編集：</label>
  <textarea id="content"></textarea>

  <button onclick="loadGist()">📥 Gist読込</button>
  <button onclick="saveGist()">💾 Gist保存</button>

  <script>
    async function loadGist() {
      const id = document.getElementById('gistId').value.trim();
      const res = await fetch(`https://api.github.com/gists/${id}`);
      const data = await res.json();
      const fileKey = Object.keys(data.files)[0];
      document.getElementById('content').value = data.files[fileKey].content;
    }

    async function saveGist() {
      const token = document.getElementById('token').value.trim();
      const id = document.getElementById('gistId').value.trim();
      const content = document.getElementById('content').value;

      const res = await fetch(`https://api.github.com/gists/${id}`, {
        method: 'PATCH',
        headers: {
          'Authorization': `token ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          files: {
            'template.txt': {
              content: content
            }
          }
        })
      });

      if (res.ok) {
        alert("保存しました！");
      } else {
        alert("保存に失敗しました");
      }
    }
  </script>
</body>
</html>
